<ion-header>
  <ion-toolbar>
    <ion-title>{{'label.statistics' | translate}}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Filtros de fecha -->
  <ion-grid>
    <ion-row>
      <ion-col size="12" size-md="6">
        <ion-item>
          <ion-label>{{'label.since' | translate}}</ion-label>
          <ion-datetime-button datetime="startDate"></ion-datetime-button>
        </ion-item>
        <ion-modal [keepContentsMounted]="true">
          <ng-template>
            <ion-datetime id="startDate" presentation="date" [locale]="lang" show-default-buttons="true"
              [(ngModel)]="startDate"></ion-datetime>
          </ng-template>
        </ion-modal>
      </ion-col>

      <ion-col size="12" size-md="6">
        <ion-item>
          <ion-label>{{'label.to' | translate}}</ion-label>
          <ion-datetime-button datetime="endDate"></ion-datetime-button>
        </ion-item>
        <ion-modal [keepContentsMounted]="true">
          <ng-template>
            <ion-datetime id="endDate" presentation="date" [locale]="lang" show-default-buttons="true"
              [(ngModel)]="endDate"></ion-datetime>
          </ng-template>

        </ion-modal>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col class="ion-text-center">
        <ion-button expand="block" (click)="onSearch()">
          {{'label.filter' | translate}}
        </ion-button>
      </ion-col>
      <ion-col class="ion-text-center">
        <ion-button expand="block" (click)="loadRecords()">
          {{'label.all.records' | translate}}
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Tabla con los registros -->
  <ion-grid class="log-table">
    <ion-row class="header-row">
      <ion-col size="2" class="header-col">{{'label.id' | translate}}</ion-col>
      <ion-col size="5" class="header-col">{{'label.date' | translate}}</ion-col>
      <ion-col size="2" class="header-col">{{'label.type' | translate}}</ion-col>
      <ion-col size="3" class="header-col">{{'label.duration' | translate}}</ion-col>
    </ion-row>

    <ion-row *ngFor="let log of registrosFiltrados; let i = index" class="data-row">
      <ion-col size="2" class="data-col">{{ log.Id }}</ion-col>
      <ion-col size="5" class="data-col">{{ formatDate(log.Timestamp) }}</ion-col>
      <ion-col size="2" class="data-col">{{ log.IsActive ? ('label.start' | translate) : ('label.end' | translate) }}</ion-col>
      <ion-col size="3" class="data-col">{{ getTimeDiff(log) }}</ion-col>
    </ion-row>

    <ion-row *ngIf="registrosFiltrados.length === 0">
      <ion-col class="ion-text-center">
        {{'label.no.records' | translate}}
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Total acumulado -->
  <ion-card *ngIf="totalTiempo">
    <ion-card-content>
      <strong>{{'label.total.time' | translate}}</strong> {{ totalTiempo }}
    </ion-card-content>
  </ion-card>

</ion-content>